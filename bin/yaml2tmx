#! /usr/bin/env ruby

require 'any2tmx'

options = Any2Tmx::Options.new('yaml2tmx')

unless options.valid?
  puts options.errors.first
  exit 1
end

if options.help?
  options.print_help
  exit 0
end

transform = Any2Tmx::Transforms::YamlTransform.new(options)
result = transform.result

STDERR.write("Matched #{result.processed_count} of #{result.source_phrase_count} source phrases\n")

stream = if options.output
  File.open(options.output, 'w+')
else
  STDOUT
end

result.write(stream)

if options.output
  STDERR.write("Wrote #{options.output}\n")
end
